@prefix mydomain: <http://tib.eu/gesah/individual> .
@prefix gesah: <http://ontology.tib.eu/gesah/> .
@prefix display: <http://vitro.mannlib.cornell.edu/ontologies/display/1.1#>

gesah:Drawing display:hasCustomView mydomain:imageSearchShortView .
gesah:Print display:hasCustomView mydomain:imageSearchShortView .
gesah:Photomechanical_Print display:hasCustomView mydomain:imageSearchShortView .
gesah:Painting display:hasCustomView mydomain:imageSearchShortView .
gesah:Digital_Image display:hasCustomView mydomain:imageSearchShortView .

mydomain:imageSearchShortView 
  a display:customViewForIndividual ; 
  display:appliesToContext "SEARCH" ;
  display:hasTemplate "image_search_short_view.ftl" ;
  display:hasDataGetter mydomain:imageSearchShortViewDataGetter ;
  display:hasDataGetter mydomain:imagePersonInfoSearchShortViewDataGetter .

mydomain:imagePersonInfoSearchShortViewDataGetter
  a <java:edu.cornell.mannlib.vitro.webapp.utils.dataGetter.SparqlQueryDataGetter> ;
  display:saveToVar "personInfo" ;
  display:query
     """
     PREFIX gesah: <http://ontology.tib.eu/gesah/>
     PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>
     SELECT DISTINCT ?label
     WHERE {
       ?individualUri gesah:has_mark_designation ?mark .
       ?mark gesah:uses_mark ?person .
       ?person rdfs:label ?label .
     }
     """ .

mydomain:imageSearchShortViewDataGetter
  a <java:edu.cornell.mannlib.vitro.webapp.utils.dataGetter.SparqlQueryDataGetter> ;
  display:saveToVar "imageInfo" ;
  display:query
     """
     PREFIX gesah: <http://ontology.tib.eu/gesah/>
     SELECT DISTINCT ?barcode ?fileNum
        WHERE {
            {
                ?individualUri gesah:has_digital_representation ?digRep .
                ?digRep gesah:barcode ?barcode .
                ?digRep gesah:image_file_number ?fileNum .
            }
            UNION
            {
                ?individualUri a gesah:Digital_Image .
                ?individualUri gesah:barcode ?barcode .
                ?individualUri gesah:image_file_number ?fileNum .
            }
        } ORDER BY ASC(?fileNum) LIMIT 1 OFFSET 1

     """ .
